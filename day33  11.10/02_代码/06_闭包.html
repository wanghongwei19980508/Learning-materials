<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script>
        /*
            闭包:
                是 JavaScript中 函数的一种 高级应用方式
                目的就是调用使用函数中的数据

            必须要解决的问题1:
                为什么函数内部的数据,无法在函数外部被访问?
                    再次了解函数的执行过程

                    1,函数的封装
                        创建一个存储空间,赋值内存地址,准备存储函数程序
                        将函数程序,以字符串形式存储在,内存空间中
                        将内存地址,赋值给,变量或者函数名称存储

                    2,函数的调用
                        通过函数名称或者变量中存储的 内存地址 找到 存储空间 获取其中存储的函数代码字符串
                        给形参赋值实参
                        代码的预解析
                        执行代码程序
                            之前,函数的代码以字符串的形式存储
                            定义的变量,定义的数据,都没有被执行,都不存在

                            只有在执行函数时,才会解析执行这些代码程序,这些变量数据,才会存在

                            这些 函数中定义的 数据,都会存储在函数的有一个专门的 存储空间中 --- 称为 执行空间

                            当函数执行结束, 执行空间 就会被 销毁 其中存储的 变量,数据等也会一起 被销毁

                            这些定义在函数内部的变量,数据等,在函数执行结束之后,就不会再存在了

                    3, 如果要可以调用函数内部的数据
                       就要保证 函数的执行空间 不会被 销毁
                            创建不会被销毁的执行空间的条件
                                (1) 有一个函数A 
                                (2) 函数A 的返回值 是 一个 引用数据类型
                                (3) 在函数外部,有一个变量,存储函数A的返回值

                            function fun(){
                                return {} 或者 [] 或者 function(){}
                            }

                            const res = fun();

                        原理:
                            假如,返回值是一个 基本数据类型 变量res 中 存储的是 基本数据类型的数值
                                 数值已经存储在 变量res 中 根函数就没有任何关系了
                                 函数的执行空间就可以被销毁,变量数据等,就可以不存在

                            假如,返回值是一个 引用数据类型 变量res 中 存储的是 引用数据类型的内存地址
                                 如果函数被销毁,引用数据类型就会被销毁,内存地址,是不存在了,res中存储的内存地址就失效了
                                 因此 函数的执行空间会被保留 内存地址也就会一直存在

                    
                    4, 闭包的执行条件:
                        有一个函数A 返回值是一个函数B
                        在返回值的函数B中 调用使用了函数A中的数据
                        在函数外部,有一个变量,存储函数B
                        函数B的返回值,是调用使用的函数A中的数据

                    5, 闭包的特点 --- 优点同时也是缺点
                        (1) 生成一个不会被销毁的执行空间
                            优点: 数据的寿命周期被延长
                            缺点: 占用内存,容易被黑客攻击泄露

                        (2) 保护数据,不会被全局污染
                            优点: 确保了数据的安全性,不会被全局污染
                            缺点: 访问不方便
                        

                总结:
                    1,闭包是函数的一种高级应用方法

                    2,本质: 生成一个不回被销毁的执行空间,可以调用访问函数中的数据

                    3,基本条件:
                        函数A 返回值是 函数B
                        函数B中调用函数A中的数据
                        函数A外部 有变量 存储函数A的执行结果, 也就是 函数B
                        
                    4,基本作用:
                        为了防止 全局变量 被 其他程序污染
                        将 全局作用域变量 定义在 函数内部 变成 局部作用变量
                        再通过闭包的方式 来 访问调用数据 


        */

        function funA(){
            let int = 100;
            let str = '北京';

            // 返回值 是另一个函数
            return function funB(){
                // 在这个函数B中,调用使用了函数A的数据
                const obj = {number:int , string:str};
                return obj;
            }
        }

        // 在函数外部,有变量,存储函数A的执行结果返回值,也就是函数B
        const res = funA();


    </script>
</body>
</html>